{% extends "blog/base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'blog/css/style.css' %}">

<h2>All Posts</h2>

<!-- Search bar -->
<form method="get" action="{% url 'search-posts' %}">
    <input type="text" name="q" placeholder="Search by title, content, or tag..." />
    <button type="submit">Search</button>
</form>

<br />

<!-- Create new post button/link -->
{% if user.is_authenticated %}
    <p>
        <a href="{% url 'post-create' %}">+ Create New Post</a>
    </p>
{% else %}
    <p>
        <a href="{% url 'login' %}">Login</a> to create a post.
    </p>
{% endif %}

<hr />

<!-- Posts list -->
{% for post in posts %}
    <article>
        <h3>
            <a href="{% url 'post-detail' post.pk %}">
                {{ post.title }}
            </a>
        </h3>

        <p>
            By <strong>{{ post.author }}</strong> â€¢ {{ post.published_date }}
        </p>

        <!-- Tags -->
        <p>
            {% for tag in post.tags.all %}
                <a href="{% url 'posts-by-tag' tag.name %}">
                    #{{ tag.name }}
                </a>
            {% empty %}
                <span>No tags</span>
            {% endfor %}
        </p>

        <!-- Snippet -->
        <p>
            {{ post.content|truncatechars:120 }}
        </p>

        <hr />
    </article>
{% empty %}
    <p>No posts yet.</p>
{% endfor %}

{% endblock %}

